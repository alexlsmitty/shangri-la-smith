import{r as e,e as a,g as l,i as r,k as s,f as o,z as u,A as i,o as n,h as d,n as t,l as m,t as v,p as c,j as p}from"./vendor-fZwiNsBY.js";import{_ as w,A as f}from"./index-CV7Tce-X.js";import"./ui-framework-B1OpzUlH.js";const g={class:"login-view"},b={class:"d-flex align-center justify-space-between mb-6"},y={class:"text-center mt-6"},V={class:"text-body-2"},P={class:"text-center mt-6"},h={class:"text-body-2"},k=w({__name:"LoginView",setup(w){const k=u(),_=i(),x=e({identifier:"",password:"",rememberMe:!0}),U=e(!1),q=e(null),T=e(!1),A=e({username:"",email:"",password:"",confirmPassword:"",agreeToTerms:!1}),S=e({identifier:"",password:""}),j=e({username:"",email:"",password:"",confirmPassword:""}),C=a((()=>x.value.identifier&&x.value.password)),I=a((()=>A.value.username&&A.value.email&&A.value.password&&A.value.password===A.value.confirmPassword&&A.value.agreeToTerms));async function z(){var e,a;if(S.value={identifier:"",password:""},q.value=null,x.value.identifier||(S.value.identifier="Username or email is required"),x.value.password||(S.value.password="Password is required"),C.value){U.value=!0;try{const e=await f.login({identifier:x.value.identifier,password:x.value.password});f.setAuthToken(e.token);const a=_.query.redirect||"/my-account";k.push(a)}catch(l){q.value=(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.error)||"Invalid username or password. Please try again."}finally{U.value=!1}}}async function E(){var e,a;j.value={username:"",email:"",password:"",confirmPassword:""},q.value=null;let l=!0;if(A.value.username?A.value.username.length<3&&(j.value.username="Username must be at least 3 characters",l=!1):(j.value.username="Username is required",l=!1),A.value.email?/^\S+@\S+\.\S+$/.test(A.value.email)||(j.value.email="Please enter a valid email address",l=!1):(j.value.email="Email is required",l=!1),A.value.password?A.value.password.length<6&&(j.value.password="Password must be at least 6 characters",l=!1):(j.value.password="Password is required",l=!1),A.value.password!==A.value.confirmPassword&&(j.value.confirmPassword="Passwords do not match",l=!1),A.value.agreeToTerms||(q.value="You must agree to the terms and conditions",l=!1),l){U.value=!0;try{const e=await f.register({username:A.value.username,email:A.value.email,password:A.value.password});f.setAuthToken(e.token),k.push("/my-account")}catch(r){q.value=(null==(a=null==(e=r.response)?void 0:e.data)?void 0:a.error)||"Registration failed. Please try again."}finally{U.value=!1}}}function M(){T.value=!T.value,q.value=null}return(e,a)=>{const u=o("v-card-title"),i=o("v-alert"),w=o("v-text-field"),f=o("v-checkbox"),k=o("v-btn"),_=o("v-form"),L=o("v-card"),R=o("v-col"),Y=o("v-row"),D=o("v-container");return n(),l("div",g,[r(D,{class:"py-12"},{default:s((()=>[r(Y,{justify:"center"},{default:s((()=>[r(R,{cols:"12",sm:"10",md:"8",lg:"6"},{default:s((()=>[r(L,{class:"pa-6 elevation-3"},{default:s((()=>[r(u,{class:"text-center text-h4 pb-4"},{default:s((()=>[m(v(T.value?"Create Account":"Login to Your Account"),1)])),_:1}),q.value?(n(),d(i,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:""},{default:s((()=>[m(v(q.value),1)])),_:1})):t("",!0),T.value?(n(),d(_,{key:2,onSubmit:c(E,["prevent"])},{default:s((()=>[r(w,{modelValue:A.value.username,"onUpdate:modelValue":a[3]||(a[3]=e=>A.value.username=e),label:"Username","error-messages":j.value.username,variant:"outlined","prepend-inner-icon":"mdi-account",required:""},null,8,["modelValue","error-messages"]),r(w,{modelValue:A.value.email,"onUpdate:modelValue":a[4]||(a[4]=e=>A.value.email=e),label:"Email",type:"email","error-messages":j.value.email,variant:"outlined","prepend-inner-icon":"mdi-email",required:""},null,8,["modelValue","error-messages"]),r(w,{modelValue:A.value.password,"onUpdate:modelValue":a[5]||(a[5]=e=>A.value.password=e),label:"Password",type:"password","error-messages":j.value.password,variant:"outlined","prepend-inner-icon":"mdi-lock",required:""},null,8,["modelValue","error-messages"]),r(w,{modelValue:A.value.confirmPassword,"onUpdate:modelValue":a[6]||(a[6]=e=>A.value.confirmPassword=e),label:"Confirm Password",type:"password","error-messages":j.value.confirmPassword,variant:"outlined","prepend-inner-icon":"mdi-lock-check",required:""},null,8,["modelValue","error-messages"]),r(f,{modelValue:A.value.agreeToTerms,"onUpdate:modelValue":a[7]||(a[7]=e=>A.value.agreeToTerms=e),label:"I agree to the Terms and Privacy Policy",required:""},null,8,["modelValue"]),r(k,{color:"primary",size:"large",block:"",loading:U.value,disabled:!I.value,type:"submit"},{default:s((()=>a[12]||(a[12]=[m(" Create Account ")]))),_:1},8,["loading","disabled"]),p("div",P,[p("p",h,[a[14]||(a[14]=m(" Already have an account? ")),r(k,{variant:"text",color:"primary",class:"ml-1",onClick:M},{default:s((()=>a[13]||(a[13]=[m(" Sign In ")]))),_:1})])])])),_:1})):(n(),d(_,{key:1,onSubmit:c(z,["prevent"])},{default:s((()=>[r(w,{modelValue:x.value.identifier,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value.identifier=e),label:"Username or Email","error-messages":S.value.identifier,variant:"outlined","prepend-inner-icon":"mdi-account",required:""},null,8,["modelValue","error-messages"]),r(w,{modelValue:x.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value.password=e),label:"Password",type:"password","error-messages":S.value.password,variant:"outlined","prepend-inner-icon":"mdi-lock",required:""},null,8,["modelValue","error-messages"]),p("div",b,[r(f,{modelValue:x.value.rememberMe,"onUpdate:modelValue":a[2]||(a[2]=e=>x.value.rememberMe=e),label:"Remember me","hide-details":""},null,8,["modelValue"]),r(k,{variant:"text",color:"primary",class:"text-caption"},{default:s((()=>a[8]||(a[8]=[m(" Forgot Password? ")]))),_:1})]),r(k,{color:"primary",size:"large",block:"",loading:U.value,disabled:!C.value,type:"submit"},{default:s((()=>a[9]||(a[9]=[m(" Sign In ")]))),_:1},8,["loading","disabled"]),p("div",y,[p("p",V,[a[11]||(a[11]=m(" Don't have an account? ")),r(k,{variant:"text",color:"primary",class:"ml-1",onClick:M},{default:s((()=>a[10]||(a[10]=[m(" Sign Up ")]))),_:1})])])])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1})])}}},[["__scopeId","data-v-2c75b04a"]]);export{k as default};
