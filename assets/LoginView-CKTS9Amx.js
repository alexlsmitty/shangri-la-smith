import{_ as N,r as c,c as S,b as j,e as r,g as l,a as i,s as z,v as D,o as y,d as P,i as Y,h as d,t as A,j as C,f as _,A as V}from"./index-BDwX7PDV.js";const $={class:"login-view"},G={class:"d-flex align-center justify-space-between mb-6"},H={class:"text-center mt-6"},J={class:"text-body-2"},K={class:"text-center mt-6"},O={class:"text-body-2"},Q={__name:"LoginView",setup(W){const k=z(),R=D(),t=c({identifier:"",password:"",rememberMe:!0}),p=c(!1),m=c(null),b=c(!1),a=c({username:"",email:"",password:"",confirmPassword:"",agreeToTerms:!1}),w=c({identifier:"",password:""}),n=c({username:"",email:"",password:"",confirmPassword:""}),x=S(()=>t.value.identifier&&t.value.password),L=S(()=>a.value.username&&a.value.email&&a.value.password&&a.value.password===a.value.confirmPassword&&a.value.agreeToTerms);async function E(){var o,e;if(w.value={identifier:"",password:""},m.value=null,t.value.identifier||(w.value.identifier="Username or email is required"),t.value.password||(w.value.password="Password is required"),!!x.value){p.value=!0;try{const u=await V.login({identifier:t.value.identifier,password:t.value.password});V.setAuthToken(u.token);const v=R.query.redirect||"/my-account";k.push(v)}catch(u){console.error("Login error:",u),m.value=((e=(o=u.response)==null?void 0:o.data)==null?void 0:e.error)||"Invalid username or password. Please try again."}finally{p.value=!1}}}async function F(){var e,u;n.value={username:"",email:"",password:"",confirmPassword:""},m.value=null;let o=!0;if(a.value.username?a.value.username.length<3&&(n.value.username="Username must be at least 3 characters",o=!1):(n.value.username="Username is required",o=!1),a.value.email?/^\S+@\S+\.\S+$/.test(a.value.email)||(n.value.email="Please enter a valid email address",o=!1):(n.value.email="Email is required",o=!1),a.value.password?a.value.password.length<6&&(n.value.password="Password must be at least 6 characters",o=!1):(n.value.password="Password is required",o=!1),a.value.password!==a.value.confirmPassword&&(n.value.confirmPassword="Passwords do not match",o=!1),a.value.agreeToTerms||(m.value="You must agree to the terms and conditions",o=!1),!!o){p.value=!0;try{const v=await V.register({username:a.value.username,email:a.value.email,password:a.value.password});V.setAuthToken(v.token),k.push("/my-account")}catch(v){console.error("Registration error:",v),m.value=((u=(e=v.response)==null?void 0:e.data)==null?void 0:u.error)||"Registration failed. Please try again."}finally{p.value=!1}}}function T(){b.value=!b.value,m.value=null}return(o,e)=>{const u=i("v-card-title"),v=i("v-alert"),f=i("v-text-field"),U=i("v-checkbox"),g=i("v-btn"),q=i("v-form"),h=i("v-card"),I=i("v-col"),B=i("v-row"),M=i("v-container");return y(),j("div",$,[r(M,{class:"py-12"},{default:l(()=>[r(B,{justify:"center"},{default:l(()=>[r(I,{cols:"12",sm:"10",md:"8",lg:"6"},{default:l(()=>[r(h,{class:"pa-6 elevation-3"},{default:l(()=>[r(u,{class:"text-center text-h4 pb-4"},{default:l(()=>[d(A(b.value?"Create Account":"Login to Your Account"),1)]),_:1}),m.value?(y(),P(v,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:""},{default:l(()=>[d(A(m.value),1)]),_:1})):Y("",!0),b.value?(y(),P(q,{key:2,onSubmit:C(F,["prevent"])},{default:l(()=>[r(f,{modelValue:a.value.username,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.username=s),label:"Username","error-messages":n.value.username,variant:"outlined","prepend-inner-icon":"mdi-account",required:""},null,8,["modelValue","error-messages"]),r(f,{modelValue:a.value.email,"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.email=s),label:"Email",type:"email","error-messages":n.value.email,variant:"outlined","prepend-inner-icon":"mdi-email",required:""},null,8,["modelValue","error-messages"]),r(f,{modelValue:a.value.password,"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.password=s),label:"Password",type:"password","error-messages":n.value.password,variant:"outlined","prepend-inner-icon":"mdi-lock",required:""},null,8,["modelValue","error-messages"]),r(f,{modelValue:a.value.confirmPassword,"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.confirmPassword=s),label:"Confirm Password",type:"password","error-messages":n.value.confirmPassword,variant:"outlined","prepend-inner-icon":"mdi-lock-check",required:""},null,8,["modelValue","error-messages"]),r(U,{modelValue:a.value.agreeToTerms,"onUpdate:modelValue":e[7]||(e[7]=s=>a.value.agreeToTerms=s),label:"I agree to the Terms and Privacy Policy",required:""},null,8,["modelValue"]),r(g,{color:"primary",size:"large",block:"",loading:p.value,disabled:!L.value,type:"submit"},{default:l(()=>e[12]||(e[12]=[d(" Create Account ")])),_:1},8,["loading","disabled"]),_("div",K,[_("p",O,[e[14]||(e[14]=d(" Already have an account? ")),r(g,{variant:"text",color:"primary",class:"ml-1",onClick:T},{default:l(()=>e[13]||(e[13]=[d(" Sign In ")])),_:1})])])]),_:1})):(y(),P(q,{key:1,onSubmit:C(E,["prevent"])},{default:l(()=>[r(f,{modelValue:t.value.identifier,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.identifier=s),label:"Username or Email","error-messages":w.value.identifier,variant:"outlined","prepend-inner-icon":"mdi-account",required:""},null,8,["modelValue","error-messages"]),r(f,{modelValue:t.value.password,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.password=s),label:"Password",type:"password","error-messages":w.value.password,variant:"outlined","prepend-inner-icon":"mdi-lock",required:""},null,8,["modelValue","error-messages"]),_("div",G,[r(U,{modelValue:t.value.rememberMe,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.rememberMe=s),label:"Remember me","hide-details":""},null,8,["modelValue"]),r(g,{variant:"text",color:"primary",class:"text-caption"},{default:l(()=>e[8]||(e[8]=[d(" Forgot Password? ")])),_:1})]),r(g,{color:"primary",size:"large",block:"",loading:p.value,disabled:!x.value,type:"submit"},{default:l(()=>e[9]||(e[9]=[d(" Sign In ")])),_:1},8,["loading","disabled"]),_("div",H,[_("p",J,[e[11]||(e[11]=d(" Don't have an account? ")),r(g,{variant:"text",color:"primary",class:"ml-1",onClick:T},{default:l(()=>e[10]||(e[10]=[d(" Sign Up ")])),_:1})])])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})])}}},Z=N(Q,[["__scopeId","data-v-2c75b04a"]]);export{Z as default};
